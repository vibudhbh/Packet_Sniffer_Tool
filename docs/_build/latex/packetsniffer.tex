%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{Packet Sniffer}
\date{Feb 04, 2025}
\release{}
\author{Vibudh Bhardwaj}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxstepscope


\chapter{Packet Sniffer Documentation}
\label{\detokenize{packet_sniffer_doc:packet-sniffer-documentation}}\label{\detokenize{packet_sniffer_doc::doc}}

\section{Overview}
\label{\detokenize{packet_sniffer_doc:overview}}
\sphinxAtStartPar
\sphinxtitleref{pktsniffer.py} is a Python\sphinxhyphen{}based packet sniffer that reads \sphinxtitleref{.pcap} files and analyzes network traffic by displaying Ethernet, IP, TCP, UDP, and ICMP headers. It includes filtering options to focus on specific packet types, host IP addresses, ports, and networks.


\section{Requirements}
\label{\detokenize{packet_sniffer_doc:requirements}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Python 3.x

\item {} 
\sphinxAtStartPar
\sphinxtitleref{scapy} library

\item {} 
\sphinxAtStartPar
\sphinxtitleref{.pcap} file for analysis

\end{itemize}

\sphinxAtStartPar
To install \sphinxtitleref{scapy}, use:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip\PYG{+w}{ }install\PYG{+w}{ }scapy
\end{sphinxVerbatim}


\section{Usage}
\label{\detokenize{packet_sniffer_doc:usage}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
python\PYG{+w}{ }pktsniffer.py\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYGZlt{}pcap\PYGZus{}file\PYGZgt{}\PYG{+w}{ }\PYG{o}{[}options\PYG{o}{]}
\end{sphinxVerbatim}


\section{Command\sphinxhyphen{}Line Arguments}
\label{\detokenize{packet_sniffer_doc:command-line-arguments}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
Argument
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxtitleref{\sphinxhyphen{}r, \textendash{}read}
&
\sphinxAtStartPar
Path to the \sphinxtitleref{.pcap} file (Required)
\\
\sphinxhline
\sphinxAtStartPar
\sphinxtitleref{\sphinxhyphen{}c, \textendash{}count}
&
\sphinxAtStartPar
Number of packets to analyze (default: all)
\\
\sphinxhline
\sphinxAtStartPar
\sphinxtitleref{\sphinxhyphen{}host}
&
\sphinxAtStartPar
Filter packets by a specific host IP address
\\
\sphinxhline
\sphinxAtStartPar
\sphinxtitleref{\sphinxhyphen{}port}
&
\sphinxAtStartPar
Filter packets by a specific port number
\\
\sphinxhline
\sphinxAtStartPar
\sphinxtitleref{\sphinxhyphen{}ip}
&
\sphinxAtStartPar
Show only IP packets
\\
\sphinxhline
\sphinxAtStartPar
\sphinxtitleref{\sphinxhyphen{}tcp}
&
\sphinxAtStartPar
Show only TCP packets
\\
\sphinxhline
\sphinxAtStartPar
\sphinxtitleref{\sphinxhyphen{}udp}
&
\sphinxAtStartPar
Show only UDP packets
\\
\sphinxhline
\sphinxAtStartPar
\sphinxtitleref{\sphinxhyphen{}icmp}
&
\sphinxAtStartPar
Show only ICMP packets
\\
\sphinxhline
\sphinxAtStartPar
\sphinxtitleref{\sphinxhyphen{}net}
&
\sphinxAtStartPar
Filter packets by a specific network address
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\section{Functionality}
\label{\detokenize{packet_sniffer_doc:functionality}}

\subsection{parse\_arguments()}
\label{\detokenize{packet_sniffer_doc:parse-arguments}}
\sphinxAtStartPar
Parses command\sphinxhyphen{}line arguments using \sphinxtitleref{argparse} and returns the parsed options.


\subsection{packet\_filter(pkt, args)}
\label{\detokenize{packet_sniffer_doc:packet-filter-pkt-args}}
\sphinxAtStartPar
Filters packets based on user\sphinxhyphen{}specified criteria.
\sphinxhyphen{} Checks for specific protocol layers (IP, TCP, UDP, ICMP).
\sphinxhyphen{} Filters packets based on host IP, port number, and network address.


\subsection{print\_packet\_summary(index, pkt)}
\label{\detokenize{packet_sniffer_doc:print-packet-summary-index-pkt}}
\sphinxAtStartPar
Prints detailed packet information, including:
\sphinxhyphen{} Ethernet header (MAC addresses, EtherType)
\sphinxhyphen{} IP header (Source/Destination IP, TTL, Flags, etc.)
\sphinxhyphen{} TCP header (Ports, Sequence/Acknowledgment numbers, Flags)
\sphinxhyphen{} UDP header (Ports, Length, Checksum)
\sphinxhyphen{} ICMP header (Type, Code, Checksum)


\subsection{main()}
\label{\detokenize{packet_sniffer_doc:main}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Parses command\sphinxhyphen{}line arguments.

\item {} 
\sphinxAtStartPar
Reads packets from the \sphinxtitleref{.pcap} file.

\item {} 
\sphinxAtStartPar
Applies filtering criteria.

\item {} 
\sphinxAtStartPar
Prints packet details for filtered packets.

\end{itemize}


\section{Example Usage}
\label{\detokenize{packet_sniffer_doc:example-usage}}
\sphinxAtStartPar
Read and analyze all packets in \sphinxtitleref{traffic.pcap}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python\PYG{+w}{ }pktsniffer.py\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }traffic.pcap
\end{sphinxVerbatim}

\sphinxAtStartPar
Filter packets to only show TCP traffic:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python\PYG{+w}{ }pktsniffer.py\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }traffic.pcap\PYG{+w}{ }\PYGZhy{}tcp
\end{sphinxVerbatim}

\sphinxAtStartPar
Filter packets to only show traffic from/to \sphinxtitleref{192.168.1.1}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python\PYG{+w}{ }pktsniffer.py\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }traffic.pcap\PYG{+w}{ }\PYGZhy{}host\PYG{+w}{ }\PYG{l+m}{192}.168.1.1
\end{sphinxVerbatim}

\sphinxAtStartPar
Filter by port \sphinxtitleref{80} (HTTP traffic):

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python\PYG{+w}{ }pktsniffer.py\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }traffic.pcap\PYG{+w}{ }\PYGZhy{}port\PYG{+w}{ }\PYG{l+m}{80}
\end{sphinxVerbatim}

\sphinxAtStartPar
Analyze the first 10 packets:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python\PYG{+w}{ }pktsniffer.py\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }traffic.pcap\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }\PYG{l+m}{10}
\end{sphinxVerbatim}


\section{Notes}
\label{\detokenize{packet_sniffer_doc:notes}}\begin{itemize}
\item {} 
\sphinxAtStartPar
If an invalid network address is provided, the script will discard the filter.

\item {} 
\sphinxAtStartPar
If multiple filters are specified, packets must match \sphinxstylestrong{all} criteria to be displayed.

\end{itemize}


\section{License}
\label{\detokenize{packet_sniffer_doc:license}}
\sphinxAtStartPar
This script is intended for educational and debugging purposes only. Unauthorized packet sniffing may violate network policies and laws. Use responsibly.



\renewcommand{\indexname}{Index}
\printindex
\end{document}